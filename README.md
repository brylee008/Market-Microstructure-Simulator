I am designing a synthetic simulation of market microstructure. 

The steps are as follows: 
1) rolling VWAP/TWAP with partial fills
2) Smart-order routing: top of book sweep (fees + latency penalty)
3) Iceberg detector (toy) with a scaffold to start
4) level - 2 order book simulator

   
